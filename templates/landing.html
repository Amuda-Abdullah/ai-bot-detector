<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bot Text Detector</title>
    <link rel="icon" type="image/" href="../static/images/bot-detector.jpg" />
    <script src="https://cdn.tailwindcss.com"></script>

  </head>
  <body class="bg-gray-50">
    <nav class="bg-white shadow-lg">
      <div class="max-w-7xl mx-auto px-4 py-3">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <img
              src="/static/images/logo.png"
              alt="Logo"
              class="h-10 w-10 rounded-lg"
            />
            <span class="ml-3 text-xl font-bold text-gray-800"
              >Bot Text Detector</span
            >
          </div>
        </div>
      </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 py-8">
      <!-- Hero Section -->
      <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">
          Detect Bot-Generated Content
        </h1>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto">
          Our advanced Bot detection tool helps you identify whether text was
          written by a human or generated by Bot.
        </p>
      </div>

      <!-- Features Grid -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
        <div class="bg-white p-6 rounded-lg shadow-md">
          <img
            src="/static/images/accuracy.png"
            alt="Accuracy Icon"
            class="w-16 h-16 mb-4"
          />
          <h3 class="text-xl font-semibold mb-2">High Accuracy</h3>
          <p class="text-gray-600">
            Advanced algorithms ensure precise detection of Bot-generated
            content.
          </p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <img
            src="/static/images/instant.jpg"
            alt="Speed Icon"
            class="w-20 h-16 mb-4"
          />
          <h3 class="text-xl font-semibold mb-2">Instant Results</h3>
          <p class="text-gray-600">
            Get analysis results in seconds, no waiting required.
          </p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <img
            src="/static/images/privacy.png"
            alt="Privacy Icon"
            class="w-20 h-16 mb-4"
          />
          <h3 class="text-xl font-semibold mb-2">Privacy First</h3>
          <p class="text-gray-600">
            Your content is analyzed securely and never stored.
          </p>
        </div>
      </div>

      <!-- Text Analysis Section -->
      <div class="bg-white rounded-xl shadow-md p-8 mb-12">
        <h2 class="text-2xl font-bold mb-6">Analyze Your Text</h2>
        <form id="analysis-form" class="space-y-6">
          <div>
            <textarea
              id="content"
              minlength="100"
              maxlength="1500"
              name="input_text"
              rows="6"
              class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              placeholder="Paste your text here (minimum 100 characters recommended for accurate analysis)"
            ></textarea>
          </div>
          <div class="flex justify-center">
            <button
              type="submit"
              class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition duration-200"
            >
              Analyze Text
            </button>
          </div>
        </form>

        <div id="results" class="mt-8 hidden">
          <div class="border-t pt-6">
            <h3 class="text-xl font-semibold mb-4">Analysis Results</h3>
            <div class="bg-gray-50 p-6 rounded-lg">
              <div class="flex items-center justify-between mb-4">
                <span class="text-lg font-medium">Bot Detection Score:</span>
                <span id="score" class="text-2xl font-bold text-blue-600"
                  >90%</span
                >
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div
                  id="score-bar"
                  class="bg-blue-600 h-2.5 rounded-full"
                  style="width: 90%"
                ></div>
              </div>

              <p class="my-2" id="result-message"></p>
              <div id="results-analysis">
                <div class="bg-gray-50"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- How It Works Section -->
      <div class="mb-12">
        <h2 class="text-2xl font-bold mb-6">How It Works</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="flex flex-col items-center text-center">
            <div class="bg-blue-100 rounded-full p-4 mb-4">
              <img
                src="/static/images/paste.png"
                alt="Step 1"
                class="w-12 h-12"
              />
            </div>
            <h3 class="text-lg font-semibold mb-2">1. Paste Your Text</h3>
            <p class="text-gray-600">
              Simply paste the content you want to analyze into the text box.
            </p>
          </div>
          <div class="flex flex-col items-center text-center">
            <div class="bg-blue-100 rounded-full p-4 mb-4">
              <img
                src="/static/images/analyse.webp"
                alt="Step 2"
                class="w-12 h-12"
              />
            </div>
            <h3 class="text-lg font-semibold mb-2">2. Click Analyze</h3>
            <p class="text-gray-600">
              Our Bot model will process your text instantly.
            </p>
          </div>
          <div class="flex flex-col items-center text-center">
            <div class="bg-blue-100 rounded-full p-4 mb-4">
              <img
                src="/static/images/privacy.png"
                alt="Step 3"
                class="w-12 h-12"
              />
            </div>
            <h3 class="text-lg font-semibold mb-2">3. Get Results</h3>
            <p class="text-gray-600">
              Receive detailed analysis of Bot probability.
            </p>
          </div>
        </div>
      </div>
    </main>

    <footer class="bg-gray-800 text-white py-8">
      <div class="max-w-7xl mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <h3 class="text-lg font-semibold mb-4">About Us</h3>
            <p class="text-gray-400">
              We're dedicated to helping users identify Bot-generated content
              with cutting-edge technology.
            </p>
          </div>
          <div>
            <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
            <ul class="space-y-2 text-gray-400">
              <li><a href="#" class="hover:text-white">Home</a></li>
              <li><a href="#" class="hover:text-white">How It Works</a></li>
              <li><a href="#" class="hover:text-white">Privacy Policy</a></li>
            </ul>
          </div>
          <div>
            <h3 class="text-lg font-semibold mb-4">Contact</h3>
            <p class="text-gray-400 mt-2 relative inline-block">
              Got Questions? Reach me 
              <a href="mailto:amudaabdullah35@gmail.com" class="text-white font-medium relative group hover:text-gray-200">
                amudaabdullah35@gmail.com
                <span className="absolute right-0 top-6 w-0 h-[2px] bg-yellow-400 transition-all duration-300 ease-in-out group-hover:w-full group-hover:left-0"></span>
              </a>
            </p>
            <a
            target="_blank"
                  rel="noopener noreferrer"
              href="{{ url_for('whatsapp_redirect') }}"
              class="text-white hover:text-green-400 font-medium"
            >
              Chat on WhatsApp
            </a>
          </div>
        </div>
        <div
          class="mt-8 pt-8 border-t border-gray-700 text-center text-gray-400"
        >
          <p>&copy; 2025 Bot Text Detector. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>

<script>
  document
    .getElementById("analysis-form")
    .addEventListener("submit", function (e) {
      e.preventDefault();
      const text = document.getElementById("content").value;

      // Show loading state
      document.querySelector('button[type="submit"]').innerHTML = `
        <span class="inline-flex items-center">
          <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Analyzing...
        </span>
      `;

      // Make API call
      fetch("/predict", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          input_text: text,
        }),
      })
        .then((response) => {
          if (!response.ok) throw new Error("Network response was not ok");
          return response.json();
        })
        .then((data) => {
          // Show results section
          document.getElementById("results").classList.remove("hidden");

          const score = data.data?.fakePercentage || 0;
          const scoreBar = document.getElementById("score-bar");
          const scoreText = document.getElementById("score");

          // Reset bar for animation
          scoreBar.style.width = "0%";
          void scoreBar.offsetWidth; // Trigger reflow

          // Animate to actual score
          scoreBar.style.width = score + "%";
          scoreText.textContent = score + "%";

          // Set colors based on threshold (50% = AI)
          const isAI = score >= 50;
          scoreBar.classList.remove("bg-blue-600", "bg-red-600", "bg-green-600");
          scoreText.classList.remove("text-blue-600", "text-red-600", "text-green-600");
          
          if (isAI) {
            scoreBar.classList.add("bg-red-600");
            scoreText.classList.add("text-red-600");
          } else {
            scoreBar.classList.add("bg-green-600");
            scoreText.classList.add("text-green-600");
          }

          // Update result message
          const messageElement = document.getElementById("result-message");
          messageElement.innerHTML = "";

          let feedbackText = data.data.feedback 
            ? data.data.feedback.replace(/AI\/GPT/g, "BOT")
            : generateFallbackMessage(score);
          
          messageElement.textContent = feedbackText;

          // Highlight suspicious sentences (if available)
          if (data.data?.originalParagraph) {
            const resultsDiv = document.querySelector("#results-analysis .bg-gray-50");
            resultsDiv.innerHTML = "";
            
            let inputText = data.data.input_text;
            let botSentences = data.data.h || [];
            
            botSentences.sort((a, b) => b.length - a.length).forEach((sentence) => {
              const escaped = sentence.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
              inputText = inputText.replace(
                new RegExp(escaped, "gi"),
                `<span class="text-red-600 font-bold">${sentence}</span>`
              );
            });

            const detailsDiv = document.createElement("div");
            detailsDiv.classList.add("mt-4", "pt-4", "border-t", "border-gray-200");
            detailsDiv.innerHTML = `
              <h4 class="font-medium mb-2">Analysis Details</h4>
              <div class="text-sm text-gray-600">
                <p class="mb-2">${inputText}</p>
                ${data.data.textWords ? `<p class="mb-2">Total words: ${data.data.textWords}, AI-like words: ${data.data.aiWords || 0}</p>` : ''}
              </div>
            `;
            resultsDiv.appendChild(detailsDiv);
          }
        })
        .catch((error) => {
          console.error("Error:", error);
          document.getElementById("results").classList.remove("hidden");
          document.getElementById("result-message").textContent =
            "Error analyzing text. Please try again.";
        })
        .finally(() => {
          document.querySelector('button[type="submit"]').innerHTML = "Analyze Text";
        });

      // Helper function for fallback messages
      function generateFallbackMessage(score) {
        if (score > 80) return "This text was likely generated by BOT.";
        if (score > 40) return "This text shows some BOT characteristics, but results are inconclusive.";
        return "This text was likely written by a human.";
      }
    });
</script>

<style>
  /* Smooth animations */
  #score-bar {
    transition: width 0.8s ease-in-out, background-color 0.5s ease-in-out;
  }
  #score {
    transition: color 0.5s ease-in-out;
  }
</style>